% \pagebreak[4]
% \hspace*{1cm}
% \pagebreak[4]
% \hspace*{1cm}
% \pagebreak[4]
%\usepackage[round,colon,authoryear]{natbib}

\chapter{Detecting Rho-independent terminators in genomic sequence with covariance models}
\label{sec:chapterPingpong}
\ifpdf
    \graphicspath{{Chapter4/Chapter4Figs/EPS/}{Chapter4/Chapter4Figs/}}
\fi

\textit{Portions of this chapter are based on the previously published article ``RNIE: genome-wide prediction of bacterial intrinsic terminators'' \parencite{Gardner2011a}. This work is the result of collaboration with Paul P. Gardner (Wellcome Trust Sanger Institute/University of Canterbury). }

\section{Introduction}

Bacteria are thought to utilize two major systems for transcriptional termination: Rho-dependent termination, and Rho-independent or intrinsic termination \parencite{Peters2011}. Rho-dependent termination relies on a protein cofactor, Rho, a homohexameric ring protein that threads its way along the newly synthesized RNA molecule before causing RNA polymerase (RNAP\nomenclature[Z]{RNAP}{RNA polymerase}) to dissociate at poorly defined pause sites. Intrinsic termination on the other hand, depends primarily on the biophysical characteristics of the sequence being transcribed. The detection of these intrinsic terminators in genomic sequence is the subject of this chapter. This chapter will serve largely as background and motivation for the next, in which I develop computational methods for identifying and characterizing transcriptional termination motifs across the bacterial phylogeny.

\subsection{Rho-independent termination}

Intrinsic termination is mediated by short structured RNA motifs known as Rho-independent terminators (RITs\nomenclature[Z]{RIT}{Rho-independent terminator}). These are generally characterized by a G+C-rich hairpin followed by a tract of T (as DNA) / U (as RNA) residues. As RNAP transcribes the poly-U tract it pauses, possibly with assistance from the partially formed hairpin structure, allowing full nucleation of the hairpin which melts weak rU-dA bonds within the elongation complex and leads to dissociation of RNAP \parencite{Peters2011}, see figure \ref{fig:rho}. This process is somewhat stochastic, and the probability of successful transcription termination depends on various features of the RIT including stem composition and length, loop composition, length of the poly-U tract, and the sequence context of the element \parencite{Larson2008, Cambray2013, Chen2013}. As is well known from the study of transcriptional attenuators and riboswitches \parencite{Henkin2002, Barrick2007, Naville2010}, alternative structures formed upstream of the RIT can also affect termination efficiency, and force exerted on the upstream sequence can increase termination efficiency even in the absence of obvious alternative structures \parencite{Larson2008}.

\begin{figure}[htp]
\begin{center}
\includegraphics[width=14cm]{rhoindy.jpg}
\caption[Rho-independent termination]{\textbf{Rho-independent termination.} A) The RNA polymerase traverses the DNA template strand from $3^\prime$  to $5^\prime$ , synthesizing the nascent RNA molecule. B) As the polymerase nears a termination site, a G+C-rich terminator stem sequence (boxed) is transcribed. C) Formation of a hairpin structure causes the polymerase to pause, and together with a string of unstable rU-dA bonds causes the polymerase to release from the template. Reproduced from \textcite{Gardner2011a}.
} 
\label{fig:rho}
\end{center}
\end{figure}

The degree to which bacteria rely on intrinsic termination varies widely. A bioinformatic analysis examining the computationally predicted minimum free energy (MFE\nomenclature[Z]{MFE}{Minimum free energy}) of gene terminuses showed that while some species display an enrichment of strong RNA secondary structure potential at the $3^\prime$ ends of genes, others do not \parencite{Washio1998}. Mutagenesis studies support this conculsion: while Rho is essential in some genomes with fewer apparent intrinsic terminators (for instance, \textit{Salmonella enterica}, see table \ref{tab:core}), it is dispensable in others that are more heavily dependent on intrinsic termination, such as \textit{Bacillus subtilis} \parencite{Quirk1993}. This suggests competition between the two termination systems, leading to clade-specific skews in RIT utilization \parencite{Carafa1990, Kroger1998, Hoon2005}. The accurate prediction of these elements is critical to understanding the regulation of transcription, particularly in light of the $\ge$3000 completed bacterial genomes currently deposited in EMBL-bank. In addition to their obvious role in helping to define operon structures in genomic sequence \parencite{Salgado2013}, they can also be important indicators of cis-RNA regulation \parencite{Henkin2002, Barrick2007, Naville2010}. Finally, the importance of RITs in designing synthetic genetic circuits has recently been recognized, and this has driven studies attempting to broaden our understanding of the factors affecting intrinsic termination efficiency \parencite{Cambray2013, Chen2013}.

\subsection{Previous approaches to identifying intrinsic terminators}

Two main approaches to detecting RITs have been taken over the years: RNA motif descriptors, both expertly constructed \parencite{Lesnik2001} and automatically generated \parencite{Naville2011}; and thermodynamic models of RNA folding to detect hairpins paired with a heuristic scoring scheme for the poly-T tail region \parencite{Ermolaeva2000, Wan2005, Wan2006, Kingsford2007}. Arguably the most popular of these methods has been TransTermHP \parencite{Kingsford2007}, an example of the second approach.

\begin{figure}[htp]
\begin{center}
\includegraphics[width=14cm]{transterm}
\caption[TransTermHP motif]{\textbf{TransTermHP motif.} Schematic of the terminator motif that TransTermHP searches for. The terminators consist of a short stem-loop hairpin followed by a thymine-rich region on their $3^\prime$ side. TransTermHP is generally restricted to find terminators where each side of the stem is $\ge$4 nt, the length of the loop is $\ge$3 nt and $\le$13 nt, and the total length of the stem-loop is $\le$59 nt. Reproduced under a Creative Commons Attribution License (CCAL) from \textcite{Kingsford2007}.
} 
\label{fig:transterm}
\end{center}
\end{figure}

The TransTermHP algorithm takes a windowed approach to detecting RITs (figure \ref{fig:transterm}). In order to avoid the computational cost of predicting local secondary structure across the entire genome, TransTermHP first scans overlapping windows of 6 bases for those containing at least 3 T residues. Upon finding such a window, TransTermHP performs a dynamic programming procedure to predict potential hairpin structures, using a simplified version of the Zuker algorithm \parencite{Zuker1981} for {\it in silico} RNA folding parameterized using a set of experimentally validated {\it Escherichia coli} RITs \parencite{Ermolaeva2000}. This is then combined with a heuristic score for the quality of the poly-T tail \parencite{Carafa1990} which rewards T residues occurring closer to the closing base-pairs of the predicted hairpin structure. Candidate RITs are then filtered on stem length, loop length, and total length (see the caption of figure \ref{fig:transterm} for details). Finally, the combined score of surviving candidates is compared to the scores of predicted terminators in random sequence with similar GC content to that of the target genome to provide a measure of prediction quality. Search is apparently also limited to regions surrounding stop codons (\cite{Kingsford2007}; see also the discussion of the beta benchmark below), though the exact boundaries on the search space are not explicitly given in the TransTermHP documentation or publication.

This methodology presents a number of problems. First, while the thermodynamic method used to predict hairpin structures likely places some implicit restrictions on the sequence composition of the hairpin structure, it does not explicitly model conservation of residue composition across terminators. Conservation of residue composition could arise due to convergent evolution of terminator structures under selection for properties that promote strong termination in the host species, or as the results of genuine homology between RITs due to their descent from a common ancestor deposited by transposable elements, as has previously been hypothesized \parencite{Naville2010}. In addition, windowed searching for and heuristic scoring of the poly-T tail is unlikely to accurately capture the true constraints on this feature. We show here that explicitly modelling residue conservation improves detection of RITs. Secondly, the comparison to random sequence with similar GC content is unlikely to be an adequate control: it has been shown that considering dinucleotide content of sequences is critical to determining the significance of their secondary structure \parencite{Workman1999}. Though the method of generating random sequence is not explicitly stated in \textcite{Kingsford2007}, it seems unlikely that it was the product of dinucleotide shuffling or a first-order Markov chain, as would be required to preserve dinucleotide frequencies. In fact TransTermHP does not appear to consider base-stacking effects in its predictions whatsoever. Finally, restricting search to the regions around annotated gene terminuses, or rewarding candidate RITs for being in these regions, is both somewhat artificial and requires accurate gene annotation, which remains a challenge. 

\subsection{Covariance models}

Our method, RNIE, overcomes many of the problems in previous RIT detection methods through the use of {\it covariance models} (CMs\nomenclature[Z]{CM}{Covariance model}), a special case of stochastic context-free grammars \parencite{Eddy1994, Sakakibara1994}. CMs are sophisticated statistical models which incorporate information about both sequence and secondary structure conservation. They are perhaps most easily understood through analogy to the simpler profile hidden Markov models (HMMs) \parencite{Eddy1998}. A typical method for HMM construction takes as its input an alignment of sequences. For each column of the alignment, a {\it node} is constructed, consisting of three {\it states}: match, insert, and delete. The match state models the residue distribution at that alignment position, while the insert and delete states model the probability and length distributions of insertions and deletions beginning at this column, respectively. The mathematics of HMMs have been well explored, and efficient dynamic programming algorithms exist for training (the Baum-Welch algorithm), assigning a probability to a sequence being produced by the model (the Forward algorithm), and finding the most probable parsing of a sequence (the Viterbi algorithm).

\begin{figure}[htp]
\begin{center}
\includegraphics[width=14cm]{cm}
\caption[Covariance model architecture]{\textbf{Covariance model architecture.} A) A toy multiple alignment of three RNA sequences, with 28 total columns, 24 of which will be modeled as consensus positions. The [structure] line annotates the consensus secondary structure: angle brackets mark base pairs, colons mark consensus single-stranded positions, and periods mark “insert” columns that will not be considered part of the consensus model because more than half the sequences in these columns contain gaps. B) The structure of one sequence from A, the same structure with positions numbered according to alignment columns, and the guide tree of nodes corresponding to that structure, with alignment column indices assigned to nodes (for example, node 5, a MATP match-pair node, will model the consensus base pair between columns 4 and 14). C) The state topology of three selected nodes of the CM, for two MATP nodes and one consensus “leftwise” single residue bulge node (MATL, “match-left”). The consensus pair and singlet states (two MPs and one ML) are white, and the insertion/deletion states are gray. State transitions are indicated by arrows. Reproduced under a Creative Commons Attribution License (CCAL) from \textcite{Nawrocki2007}.
} 
\label{fig:cm}
\end{center}
\end{figure}

CMs are similar to profile HMMs, with the extension that they can additionally model dependence between alignment positions (see figure \ref{fig:cm}); rather than nodes being constructed from alignment columns, they are built from structural elements, i.e. pairing bases, annotated in the alignment (figure \ref{fig:cm}B). This increases the complexity of node architecture (figure \ref{fig:cm}C), as each node must now contain states to match both bases in a pair, either one of a pair individually if its partner has been deleted, insertions on either side of the pair, and base pair deletions. Analogs to the Baum-Welch, Forward, and Viterbi algorithms exist for CMs: expectation-maximization using the inside-outside algorithm, the inside algorithm, and the Cocke-Younger-Kasami (CYK\nomenclature[Z]{CYK}{Cocke-Younger-Kasami (algorithm)}) algorithm, respectively. Unfortunately, modeling the dependence between positions, that is moving from a regular grammar such as an HMM to a context-free grammar such as a CM, comes at a considerable computational cost due to the restrictions imposed by the Chomsky hierarchy \parencite{Chomsky1959}, roughly equivalent to adding an additional dimension to the dynamic programming matrix. In this study we have used the Infernal package \parencite{Nawrocki2009}, which implements CMs and associated algorithms for RNA sequence analysis, and includes a number of heuristics for increasing the speed of CM-based searches including adaptive banding of the dynamic programming matrix \parencite{Nawrocki2007} and HMM pre-filters based on HMMER \parencite{Eddy2011}. Importantly, Infernal also incorporates a null model for scoring sequence hits; for sequence that matches the CM, the probability of this match is compared to the probability of a match to the null model. This comparison is expressed as a $log_2$ odds ratio, or bitscore, and from this further statistics, such as an expect value (E-value\nomenclature[Z]{E-value}{Expect value}), can be calculated. Covariance models are widely used in RNA homology search, most notably by the Rfam database \parencite{Burge2013} and the tRNAscan-SE tool \parencite{Lowe1997} for predicting tRNAs in genomic sequence.

\section{Methods}
\textit{Paul P. Gardner implemented and benchmarked the RNIE tool. Eric P. Nawrocki (Howard Hughes Medical Institute Janelia Farm Research Campus) assisted in optimizing Infernal parameters for RIT search. Zasha Weinberg (Howard Hughes Medical Institute/Yale University) ran the Rnall and Rnall-Brkr algorithms for benchmarking. I designed and implemented the analysis which lead to the discovery of the putative mycobacterial termination motif.}

\subsection{Construction of a covariance model for Rho-independent terminators}

One hundred seventy-one and 891 experimentally validated RIT sequences from \textit{Escherichia coli} and \textit{Bacillus subtilis}, respectively, were collected from the \textit{E. coli} Database Collection (ECDC; \cite{Wahl1995}) and the supplementary information of \textcite{Hoon2005} and manually curated based on evidence quality, leaving a set of 981 RIT sequences. These sequences were subjected to iterative rounds of alignment, structure prediction, homology search and refinement. Alignments and secondary structures were predicted using WAR \parencite{Torarinsson2008}, CMfinder \parencite{Yao2006}, and MLocarna \parencite{Will2007}, iteratively refined using Infernal \parencite{Nawrocki2009}, then manually refined using the RALEE emacs environment \parencite{Griffiths-Jones2005}. Sequence searches were performed using the resulting CM against EMBL with the Rfam pipeline \parencite{Gardner2009}, and additional sequences were incorporated in to the alignment based on the following criteria: i) the maximum similarity to an existing seed sequence had to be 95\% and the minimum 60\%, ii) the minimum fraction of canonical base pairs had to be 75\%, iii) the sequence annotation should not contain terms like contaminant, pseudogene, repeat or transposon and iv) they must score above a bitscore threshold of 20. These additional sequences were then manually checked for their position near a gene terminus. This resulted in 1117 aligned sequences, which were further split in to two groups based on how well they matched the resulting CM. Those scoring with a bitscore over 14 were placed in alignment A, those scoring less were placed in alignment B. These alignments were then again automatically refined using Infernal before a final round of manual refinement. 

\subsection{RNIE run modes}

As described in the introduction, algorithms for performing inference with CMs can be very slow, and as a result Infernal implements a number of filters to reduce the number of sequences which proceed to a full CM-based homology search. In response to this, two modes for RNIE were developed: genome mode meant for large-scale searches, which enables HMM filters and adaptive banding and uses the CYK algorithm with a higher threshold for reported RIT predictions; and gene mode meant for annotation of relatively short sequence regions, which disables Infernal's filtering mechanisms and uses the slower but more powerful inside algorithm with a lower threshold for reporting RIT predictions. Genome mode scans sequence at $\sim$43 kb/s\nomenclature[Z]{kb}{Kilobase} with a low false positive rate of $\sim$1.7 FP/Mb\nomenclature[Z]{Mb}{Megabase}. The sensitivity, positive predictive value and Matthews' correlation coefficient for this mode (determined in the alpha benchmark below) are 0.70, 0.79 and 0.74. Gene mode scans at $\sim$1kb/s, and the false positive rate, positive predictive value and Matthews' correlation coefficient are $\sim$9.6 FP/Mb, 0.45 and 0.61, respectively. The Infernal parameters used for genome and gene mode, respectively, are

\begin{quote}
\begin{verbatim}
cmsearch -T 16 -g --fil-no-qdb --fil-T-hmm 2 
--cyk --beta 0.05 CM query_sequence.fasta

cmsearch -T 14 -g --fil-no-qdb --fil-no-hmm 
--no-qdb --inside CM query_sequence.fasta
\end{verbatim}
\end{quote}

\subsection{Definitions}

For the purposes of benchmarking, the following measures were used \[Sensitivity = \frac{TP}{TP + FN} \] \[ PPV = \frac{TP}{TP + FP} \] \[ FPR = \frac{FP}{\text{Total length in kb}} \] \[ MCC = \frac{TP \times TN - FP \times FN}{\sqrt{(TP + FP)(TP + FN)(TN + FP)(TN + FN)}} \] where any prediction that covered a known RIT by at least one nucleotide was considered a true positive (TP), any prediction that did not overlap a known RIT was considered a false positive (FP), a missed RIT was considered a false negative (FN), and the number of unclassified, non-RIT sequence were considered true negatives (TN). \nomenclature[Z]{MCC}{Matthews correlation coefficient}

\input{Chapter4/Chapter4Tables/genomes.tex}

\section{Results}

Benchmarking a tool for RIT detection is challenging. As described in the methods section, only a relatively small number of RITs had been verified at the time of this study. While this situation is beginning  to improve with the development of high-throughput techniques for RIT characterization \parencite{Cambray2013, Chen2013}, verified RITs are still largely drawn from the model bacteria {\it E. coli} and {\it B. subtilis}. As a result, two benchmarks were performed: the first, or alpha, benchmark examines method performance on known RITs, with the caveat that these RITs formed part of the training set for RNIE and many of the other methods tested. The second, or beta, benchmark is a qualitative assessment on whole genomes with unknown RIT contents, evaluating the quality of predictions by their genomic position and estimating the FPR by the relative number of predictions on shuffled sequence.

\subsection{Alpha benchmark}

For the first benchmark 485 known RITs, curated on the basis of experimental evidence for activity, were used, drawn from the ECDC  \parencite{Wahl1995} and the supplementary information of \textcite{Hoon2005}. Each RIT was embedded in 1000 bases of randomly selected dinucleotide shuffled sequence drawn from the genomes in table \ref{tab:genomes}. For each known RIT a first-order Markov chain was trained on the nucleotide distribution of that sequence and 100 decoy sequences were generated and similarly embedded in 1000 bases of dinucleotide shuffled sequence. A first-order Markov chain was used rather than dinucleotide shuffling of the native RITs, as these short sequences may have a limited number of permutations with identical dinucleotide content. As TransTermHP will only run on annotated sequence, artificial gene annotations were added to each sequence, with either decoys or genuine RITs positioned at the $3^\prime$ end of one of the annotations. 

\begin{FPfigure}
\makebox[\textwidth]{\includegraphics[angle=-90,totalheight=\textheight]{alpha.jpg}}
\caption[Alpha benchmark]{\textbf{Alpha benchmark.} The accuracy of RNIE compared to existing methods of terminator prediction. The left figure shows a ROC plot for four independent methods. The middle figure compares the sensitivity and PPV for the four methods. The figure on the right shows the speeds for each algorithm in kilobases per second. Reproduced from \textcite{Gardner2011a}.
} 
\label{fig:alpha}
\end{FPfigure}

Four methods besides RNIE were tested (figure \ref{fig:alpha}): TransTermHP (with 2, 4, 9, or 10 gene features; \cite{Kingsford2007}), RNAmotif (using either the structural score alone (struct), or the structural score augmented with a score for hybridization between the poly-U tail and the DNA sequence (dG); \cite{Lesnik2001}), Rnall (using either the score for hairpin formation (dG), or the score for hairpin formation augmented with a score for poly-U/DNA hybridization (hbG); \cite{Wan2005, Wan2006}), and a version of Rnall modified by the Breaker lab at Yale Univeristy (Rnall-Brkr; using either the score for hairpin formation (dG), or the score for hairpin formation augmented with a score for poly-U/DNA hybridization (hbG); \cite{Barrick2007, Weinberg2007}).

The results of this benchmark show that RNIE's performance is superior to any previous method for detecting RITs at any level of sensitivity or specificity. Interestingly, all methods which rely on poly-U/DNA hybridization scores performed extremely poorly, suggesting that the understanding of the role of RNA-DNA hybridization in intrinsic termination modelled by these methods is incorrect, or at best incomplete. Of the other methods, the only ones besides RNIE which cross the line $y = 1 - x$, the performance of a hypothetical `random' predictor, on the sensitivity versus PPV plot were TransTermHP and RNAmotif. The scanning speed of RNIE in genome mode, $\sim$43 kb/s, is comparable to that of TransTermHP at $\sim$74-186 kb/s, depending on the number of gene annotations. Based on these results, thresholds were chosen for reporting RNIE RIT predictions in genome and gene modes at levels slightly below the maximum MCC, that is allowing for a slightly higher FPR in return for increased sensitivity with the assumption that false positives can often be determined by their genomic context.

\subsection{Beta benchmark}

For the second benchmark 17 genomes representative of the diversity of the bacterial phylogeny (table \ref{tab:genomes}) were scanned with both RNIE and TransTermHP, and the results compared. Additionally, dinucleotide shuffles of these genomes were scanned to provide an estimate of the FPR of each method. Genuine RITs are expected to occur preferentially in the $3^\prime$ region of annotated genes. As can be seen in figure \ref{fig:beta}, predictions for both RNIE and TransTermHP are enriched in predictions $3^\prime$ to gene annotations (solid lines). RNIE makes relatively few predictions in shuffled sequence (dashed lines), particularly in the more stringent genome mode, and these appear to be randomly distributed with respect to gene terminuses. Worryingly, TransTermHP predictions on dinucleotide shuffled sequence are also enriched at annotated gene terminus, suggesting it is giving a bonus to predictions falling in the correct genomic context. This is particularly problematic, as it suggests a higher FPR in regions where RIT predictions will look most reasonable on a passing inspection.  

\begin{FPfigure}
\makebox[\textwidth]{\begin{tabular}{c}
\includegraphics[width=10cm]{beta-1}\\
\includegraphics[width=10cm]{beta-2}
\end{tabular}}

\caption[Beta benchmark]{\textbf{Beta benchmark.} Ideal terminator predictors will generally produce predictions that are immediately $3^\prime$ to annotated genes on native sequence and no predictions on shuffled controls. For all the test genomes in Table 1 (excluding {\it E. coli} and {\it B. subtilis}), we computed the distance to the nearest $3^\prime$ genic element, including CDSs, ncRNAs and riboswitches. This was done for both native sequences and dinucleotide shuffled control sequences with corresponding gene annotation transferred to the controls. The figure on the left shows the distribution of distances for RNIE genome and gene modes and for the TransTermHP method. Inset is a barplot showing the total number of predictions for each method on native and shuffled genomes. The figures on the right show the percentage of genes that have a predicted RIT in the region $-50$ to $+150$ from an annotated $3^\prime$-end of a CDS or ncRNA across all the genome sequences described in Table 1. The upper panel illustrates the results for the native genomes, while the lower panel illustrates results for the permuted genomes. Reproduced from \textcite{Gardner2011a}.
} 
\label{fig:beta}
\end{FPfigure}

The bar plots in figure \ref{fig:beta} report the percentage of genes reported to be terminated by a RIT in each genome by TransTermHP and RNIE. In general, the number of predictions made by RNIE is comparable to TransTermHP, particularly when the higher number of predictions by TransTermHP on shuffled sequence is taken in to account. Interestingly, the only genome where RNIE predicts more RITs than TransTermHP is {\it B. subtilis}, where most of the training data for the RNIE CMs originated. Additionally, there are a number of genomes where few RITs are predicted by either method. Both of these points will be addressed in more detail in the next chapter.

\subsection{A novel termination motif in \textit{Mycobacterium tuberculosis}}

In the course of benchmarking RNIE, we noticed that neither our method nor TransTermHP made many RIT predictions in the {\it Mycobacterium tuberculosis} genome. While some bacterial lineages are hypothesized not to use intrinsic termination, there is a body of prior work suggesting that {\it M. tuberculosis} does utilize secondary structure in termination \parencite{Washio1998, Unniraman2001, Unniraman2002, Mitra2008, Mitra2009}. In particular the Nagaraja group has developed a method, GeSTer, which attempts to classify predicted secondary structures from the terminuses of coding regions in to one of five categories of structural motifs. More than 90\% of terminal motifs in {\it M. tuberculosis} fall in to their ``I-shaped" category, or short stem-loop with no poly-U tail. With this in mind, I developed the following procedure to search for a potential structured termination motif in {\it M. tuberculosis}.

\begin{figure}[htp]
\begin{center}
\includegraphics[width=14cm]{myco.jpg}
\caption[Putative mycobacterial transcription termination motif]{\textbf{Putative mycobacterial transcription termination motif.} A) The frequency of TRITs and RITs near the terminal regions of {\it M. tuberculosis} (EMBL accession: AE000516) genic features. B) The distribution of structural stability derived p-values for the most significant {\it M. tuberculosis} terminal regions coloured by TRIT (red), RIT (black) or unclassified (blue). C) The secondary structure and sequence conservation of the TRIT motif as displayed by R2R \parencite{Weinberg2011}. (D\&E) Sequence logos generated for the $5^\prime$ D) and $3^\prime$ E) halves of an alignment of the 147 copies of TRIT in the {\it M. tuberculosis} genome. Reproduced from \textcite{Gardner2011a}.
} 
\label{fig:myco}
\end{center}
\end{figure}

I extracted 100-nucleotide $3'$ sequences from the {\it Mycobacterium tuberculosis} CDC1551, starting 20 bases before annotated CDS ends. Predicted MFE folding scores for each sequence were calculated using RNAfold \parencite{Hofacker1994}. I performed a pooled permutation test for lower than expected MFEs using 1000 dinucleotide shuffles from each $3'$ sequence. I then ran the CMfinder \parencite{Yao2006} RNA motif-finder over sequences with a p-value less than 0.001. The subsequent alignment was manually refined using the RALEE RNA alignment editor \parencite{Griffiths-Jones2005}. The refined alignment was used to construct an Infernal CM \parencite{Nawrocki2009}, as had been done for canonical RITs, which was then searched across all Mycobacteria genomes in the EMBL nucleotide sequence database.

This revealed a well-conserved structured sequence motif associated with gene terminal regions in Mycobacteria which we named the tuberculosis Rho-independent terminators, or TRITs\nomenclature[Z]{TRIT}{Tuberculosis Rho-independent terminator}, in light of the source of the discovery (see Figure \ref{fig:myco}). TRITs are found across the entire genus, ranging in approximate copy-number from 150 to 250 in {\it M. abscessus}, {\it M. avium}, {\it M. bovis}, {\it M. gilvum}, {\it M intracellulare}, {\it M. kansasii}, {\it M. leprae}, {\it M. marinum}, {\it M. smegmatis}, {\it M. tuberculosis}, {\it M. ulcerans} and {\it M. vanbaalenii}. The TRITs account for 72\% (59/82) of terminal sequences with highly significant secondary structure (p $<$ 0.001) in {\it M. tuberculosis}. TRIT predictions made by our model fall overwhelmingly at the terminus of annotated coding regions, tending to start 8 bases before the annotated gene end (Figure  \ref{fig:myco}A), distinct from the distribution of RITs. In addition, TRITs appear to be associated with sharp drops in transcription in RNA-seq experiments (data presented in the next chapter). Additionally, since the publication of this study two sRNA screens in Mycobacteria have discovered TRITs apparently terminating sRNA transcription \parencite{Miotto2012, Li2013}, providing additional evidence for their activity. The high sequence conservation (Figure  \ref{fig:myco}D\&E) across elements suggests that this element has either arisen relatively recently, or possibly requires a nucleotide-binding co-factor to perform its function. In the next chapter, I describe a study scaling up this approach to discover transcriptional termination motifs across the entire bacterial phylogeny.